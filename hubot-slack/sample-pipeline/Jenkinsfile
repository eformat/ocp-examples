node {
   env.url = env.HUBOT_URL
   env.room = env.HUBOT_DEFAULT_ROOM
   
   echo env.room
   echo env.url

   hubotUrl = "HUBOT_URL=" + env.url
   hubotRoom = "HUBOT_DEFAULT_ROOM=" + env.room
   hubotFail = 'HUBOT_FAIL_ON_ERROR=false'


    def jenkinsUrl = sh (
      script: "oc get route jenkins -o jsonpath={.spec.host} -n hubot",
      returnStdout: true
    )

   env.jenkinsUrl = "https://" + jenkinsUrl + "/job/${env.JOB_NAME}/${env.BUILD_NUMBER}"

   echo env.BUILD_URL

   if (env.BUILD_URL == null) {

     env.BUILD_URL = env.jenkinsUrl
   }


  withEnv([hubotUrl, hubotRoom, hubotFail]) {
    hubotSend message: 'building job hi'
    hubotApprove message: 'Proceed with building this job?'
  }

}

